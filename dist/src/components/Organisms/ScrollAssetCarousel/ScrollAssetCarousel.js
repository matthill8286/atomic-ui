import{slicedToArray as e,extends as o,toConsumableArray as t,objectSpread2 as i}from"../../../../_virtual/_rollupPluginBabelHelpers.js";import r,{useState as s,useEffect as n}from"react";import{useInView as l}from"../../../../node_modules/react-intersection-observer/react-intersection-observer.m.js";import{CarouselWrapper as a,TileFragment as d,TileWrapper as c}from"./ScrollAssetCarousel.styled.js";import{AssetSponsoring as u}from"../AssetTile/elements/AssetSponsoring.js";import{ScrollSnapSlider as m}from"../../Molecules/ScrollSnapSlider/ScrollSnapSlider.js";import{AssetTileLayout as v}from"../AssetTile/AssetTile.interface.js";import{useWindowDimensions as p}from"../../Helper/useWindowDimensions/useWindowDimensions.js";import{breakpoints as g}from"../../../styles/sc-vars-global.js";import{AssetTile as f}from"../AssetTile/AssetTile.js";var w=function(w){var h=w.loading,k=void 0===h||h,y=w.lazyLoad,S=void 0===y||y,x=w.promoted,A=w.promotedIndex,b=void 0===A?0:A,P=w.assets,C=void 0===P?[]:P,T=w.disabledAssetIndexes,L=void 0===T?[]:T,D=w.context,I=void 0===D?"home-scroll-carousel":D,j=w.tileMargin,E=void 0===j?"md":j,B=w.withOverflow,N=void 0===B||B,_=w.withGrid,z=void 0!==_&&_,W=w.showArrows,M=void 0===W||W,G=w.showBookmark,V=void 0===G||G,F=w.NoAssetsComponent,O=w.showSkills,H=void 0===O||O,Q=w.showProvider,q=w.sponsoringDetails,J=w.showLock,K=void 0!==J&&J;w.playlistOrientation;var R=w.playlistView,U=void 0===R?"list":R,X=w.playlistLayout,Y=void 0===X?v.gridItem:X,Z=w.strategyType,$=w.videoFallbackImage,ee=w.fixedArrowPosition,oe=void 0===ee||ee,te=w.zeroArrowPosition,ie=void 0!==te&&te,re=w.renderAddToBookmarkButton,se=w.title,ne=w.tileWidth,le=void 0===ne?250:ne,ae=w.slidesPerPageSettings,de=w.hideDummies,ce=void 0!==de&&de,ue=w.dataTest;w.withLQIP,w.withNativeLoading;var me=w.withScrollbar,ve=void 0===me||me,pe=w.onAssetClick,ge=void 0===pe?function(){return null}:pe,fe=w.onLockClick,we=void 0===fe?function(){return null}:fe,he=w.onSlideChange,ke=void 0===he?function(){return null}:he,ye=w.onInView,Se=w.arrowPrevClass,xe=w.arrowNextClass,Ae=s(!1),be=e(Ae,2),Pe=be[0],Ce=be[1],Te=p().breakpoint,Le=s(0),De=e(Le,2),Ie=De[0],je=De[1],Ee=Te>=g.lg?ae.desktop:Te>=g.md?ae.tablet:ae.mobileBig,Be=l({threshold:0,triggerOnce:!0,rootMargin:"50px 0px"}),Ne=e(Be,2),_e=Ne[0],ze=Ne[1];if(n((function(){ze&&void 0!==ye&&!k&&C.length>0&&ye({context:I})}),[ze,k,ye,I,C]),!C||C.length<1)return k?null:F;var We,Me=function(e){return function(o,t,i,r){we&&we({asset:t,index:i,assetsPerSlide:e,pageNumber:r,context:I})}},Ge={loading:k,fontSize:"sm",sponsoringDetails:void 0,withEllipsis:!0},Ve=Y===v.gridItem?"portrait":"landscape",Fe=Y===v.gridItem,Oe=function(e){return function(t,s){var n=Math.floor(s/e),l=!N&&!t.description,a=i({},t),u=null!=q&&q.isSponsored?d:c,m=null==a?void 0:a.sponsored,v=Ge.loading||l,p=-1!==L.findIndex((function(e){return e===s}));return r.createElement(u,{hideDummy:l&&ce&&!Pe,"aria-rowindex":s,key:"AssetTile-".concat(s),withLabels:m},r.createElement(f,o({},Ge,{showProvider:Q,showSkills:H,badges:"collection"===U&&(null==t?void 0:t.__typename)&&[{name:null==t?void 0:t.__typename,actionType:"prominent"}]||[],videoFallbackImage:$,isCollection:"collection"===U,orientation:Ve,sponsoringDetails:void 0,showBookmark:V,showLock:K,isDisabled:p,assetView:U,assetIndex:s,fontSize:"sm",strategyType:Z,renderAddToBookmarkButton:re,onClick:function(o){return function(e){return function(o,t,i,r){Pe&&o.preventDefault(),!t.locked&&ge&&ge({asset:t,index:i,assetsPerSlide:e,pageNumber:r,context:I})}}(e)(o,t,s,n)},onLockClick:function(o){return Me(e)(o,t,s,n)},loading:v,layout:Y,asset:a,lazyLoad:S,inView:ze})))}};return r.createElement(a,o({tileMargin:E,isGridLayout:Fe,tileWidth:le,setFixedWidth:(null==ae?void 0:ae.desktop)>=4||C.length<4,ref:_e,key:"Carousel-".concat(C.length)},void 0!==ue&&{"data-test":ue}),q?r.createElement(u,{layout:"carousel",sponsoringDetails:q}):null,r.createElement(m,{slideWidth:le,isGridLayout:Fe,withGrid:z,showScrollbar:ve&&C.length>3,onScrollStart:function(){Pe||Ce(!0)},onScrollEnd:(We=Ee,function(e){Ce(!1);var o=e>Ie?"Next":"Previous",t=e/We;je(e);var i=C.slice(t*We,t*We+We);null==ke||ke({assets:i,direction:o,assetAmount:We,pageNumber:t,context:I})}),showArrows:M&&C.length>3,arrowDataTest:"scroll-snap-slider-arrow",arrowPrevClass:Se,arrowNextClass:xe,fixedArrowPosition:oe,zeroArrowPosition:ie,slidesPerPageSettings:ae,title:se},function(){if(!x)return[].concat(t(C.map(Oe(Ee))),[r.createElement("div",{key:"right-spacer"})]);var e=x?[x]:[];return[].concat(t(C.slice(0,b).map(Oe(Ee))),e,t(C.slice(b).map(Oe(Ee))),[r.createElement("div",{key:"right-spacer"})])}()))};export{w as AssetCarousel};
//# sourceMappingURL=ScrollAssetCarousel.js.map
