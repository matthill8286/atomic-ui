{"version":3,"file":"VideoPlayerCore.js","sources":["../../../../../src/components/Atoms/VideoPlayer/VideoPlayerCore.tsx"],"sourcesContent":["import React, {\n  MutableRefObject,\n  ReactElement,\n  Ref,\n  useCallback,\n  useEffect,\n  useRef,\n  useState,\n} from 'react'\nimport { useInView } from 'react-intersection-observer'\nimport { SkeletonBlockItem, SkeletonInlineItem } from '@/components/Atoms/Skeleton'\nimport {\n  VideoPlayerProps,\n  VideoPlayerViewer,\n} from '@/components/Atoms/VideoPlayer/VideoPlayer.interface'\nimport {\n  StyledVideoPlayer,\n  StyledVideoWrapper,\n} from '@/components/Atoms/VideoPlayer/VideoPlayer.styled'\n\nexport const VideoPlayerCore: React.FC<VideoPlayerProps> = ({\n  title = 'core video player',\n  videoId = 'player-core',\n  width = '100%',\n  height = '100%',\n  url,\n  pip = false,\n  controls = true,\n  light = false,\n  loop = false,\n  loading,\n  playbackRate = 1,\n  playing,\n  volume = 0.6,\n  muted = false,\n  allowfullscreen = false,\n  rounded = false,\n  stopOnUnmount = true,\n  maxHeight,\n  onStart,\n  onPause,\n  onPlay,\n  onError,\n  onEnded,\n  onProgress,\n  onDuration,\n  children,\n  ...props\n}) => {\n  if (loading) {\n    return <SkeletonBlockItem height=\"350px\" />\n  }\n\n  const containerRef = useRef<HTMLDivElement>(null)\n  const [videoViewer, setVideoViewer] = useState<VideoPlayerViewer | null>(null)\n  const [ref, inView] = useInView({\n    threshold: 0.3,\n  })\n\n  const [loaded, setLoaded] = useState(false)\n\n  const id = `video-player-container-${videoId}`\n\n  const _onStart = useCallback(cb => onStart?.(cb), [])\n\n  const _onEnded = useCallback(event => onEnded?.(event), [])\n\n  const _onPlay = useCallback(event => onPlay?.(event), [])\n\n  const _onDuration = useCallback(event => onDuration?.(event), [])\n\n  const _onPause = useCallback(event => onPause?.(event), [])\n\n  const _onProgress = useCallback(state => {\n    onProgress?.(state)\n  }, [])\n\n  const _onError = useCallback(event => onError?.(event), [])\n\n  useEffect(() => {\n    videoViewer?.onStart(() => {\n      if (!loaded) {\n        setLoaded(true)\n      }\n    })\n  }, [videoViewer])\n\n  useEffect(() => {\n    if (\n      document.fullscreenElement !== null &&\n      // eslint-disable-next-line @typescript-eslint/ban-ts-comment\n      // @ts-ignore\n      (document.fullscreenElement === true ||\n        (document.fullscreenElement as HTMLVideoElement)?.canPlayType !== undefined)\n    ) {\n      return\n    }\n    if (loaded && !inView) {\n      videoViewer?.stop()\n    }\n  }, [inView])\n\n  return (\n    <StyledVideoWrapper aspect=\"16/9\" ref={containerRef}>\n      <StyledVideoPlayer\n        id={id}\n        width={width}\n        ref={videoViewer}\n        height={height}\n        url={url}\n        pip={pip}\n        playing={playing}\n        controls={controls}\n        rounded={rounded ?? undefined}\n        light={light}\n        loop={loop}\n        playbackRate={playbackRate}\n        volume={volume}\n        muted={muted}\n        onStart={_onStart}\n        onPlay={_onPlay}\n        onPause={_onPause}\n        onProgress={_onProgress}\n        onError={_onError}\n        onDuration={_onDuration}\n      />\n      <div id={id} ref={ref} />\n    </StyledVideoWrapper>\n  )\n}\n"],"names":["VideoPlayerCore","title","videoId","width","height","url","pip","controls","light","loop","loading","playbackRate","playing","volume","muted","allowfullscreen","rounded","stopOnUnmount","maxHeight","onStart","onPause","onPlay","onError","onEnded","onProgress","onDuration","children","React","SkeletonBlockItem","containerRef","useRef","useState","videoViewer","useInView","threshold","ref","inView","loaded","setLoaded","id","_onStart","useCallback","cb","event","_onPlay","_onDuration","_onPause","_onProgress","state","_onError","useEffect","document","fullscreenElement","undefined","canPlayType","stop","StyledVideoWrapper","aspect","StyledVideoPlayer"],"mappings":"8cAoBaA,EAA8C,cACzDC,cACAC,QAAAA,aAAU,oBACVC,MAAAA,aAAQ,aACRC,OAAAA,aAAS,SACTC,IAAAA,QACAC,IAAAA,oBACAC,SAAAA,oBACAC,MAAAA,oBACAC,KAAAA,gBACAC,IAAAA,YACAC,aAAAA,aAAe,IACfC,IAAAA,YACAC,OAAAA,aAAS,SACTC,MAAAA,kBACAC,wBACAC,QAAAA,kBACAC,gBACAC,cACAC,IAAAA,QACAC,IAAAA,QACAC,IAAAA,OACAC,IAAAA,QACAC,IAAAA,QACAC,IAAAA,WACAC,IAAAA,gBACAC,2RAGIhB,SACKiB,gBAACC,GAAkBxB,OAAO,cAG7ByB,EAAeC,EAAuB,QACNC,EAAmC,eAAlEC,kBACeC,EAAU,CAC9BC,UAAW,cADNC,OAAKC,SAIgBL,GAAS,YAA9BM,QAAQC,QAETC,oCAA+BrC,GAE/BsC,GAAWC,GAAY,SAAAC,UAAMvB,MAAAA,SAAAA,EAAUuB,KAAK,IAEjCD,GAAY,SAAAE,UAASpB,MAAAA,SAAAA,EAAUoB,KAAQ,QAElDC,GAAUH,GAAY,SAAAE,UAAStB,MAAAA,SAAAA,EAASsB,KAAQ,IAEhDE,GAAcJ,GAAY,SAAAE,UAASlB,MAAAA,SAAAA,EAAakB,KAAQ,IAExDG,GAAWL,GAAY,SAAAE,UAASvB,MAAAA,SAAAA,EAAUuB,KAAQ,IAElDI,GAAcN,GAAY,SAAAO,GAC9BxB,MAAAA,GAAAA,EAAawB,KACZ,IAEGC,GAAWR,GAAY,SAAAE,UAASrB,MAAAA,SAAAA,EAAUqB,KAAQ,WAExDO,GAAU,WACRlB,MAAAA,GAAAA,EAAab,SAAQ,WACdkB,IACHC,IAAU,QAGb,CAACN,IAEJkB,GAAU,kBAEyB,OAA/BC,SAASC,oBAGuB,IAA/BD,SAASC,wBAC0DC,eAAjEF,SAASC,wCAAwCE,eAIlDjB,KAAWD,IACbJ,MAAAA,GAAAA,EAAauB,UAEd,CAACnB,IAGFT,gBAAC6B,GAAmBC,OAAO,OAAOtB,IAAKN,GACrCF,gBAAC+B,GACCnB,GAAIA,GACJpC,MAAOA,EACPgC,IAAKH,EACL5B,OAAQA,EACRC,IAAKA,EACLC,IAAKA,EACLM,QAASA,EACTL,SAAUA,EACVS,QAASA,MAAAA,EAAAA,OAAWqC,EACpB7C,MAAOA,EACPC,KAAMA,EACNE,aAAcA,EACdE,OAAQA,EACRC,MAAOA,EACPK,QAASqB,GACTnB,OAAQuB,GACRxB,QAAS0B,GACTtB,WAAYuB,GACZzB,QAAS2B,GACTxB,WAAYoB,KAEdlB,uBAAKY,GAAIA,GAAIJ,IAAKA"}